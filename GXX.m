function Gx=GXX(q)



Ms=1;Rs=.3;Is=0.06;d=.15;
Ir1=.008;Ir2=.004;Mr=0.7;Mc=0.7;
%
%*******************************************************************************
%
r1=q(1);r2=q(2);r3=q(3);r4=q(4);
%
%*******************************************************************************
%
A=zeros(6);
A(1,1)=1;
A(1,2)=0;
A(1,3)=2*Rs*r3;
A(1,4)=-2*Rs*r4;
A(1,5)=-2*Rs*r1;
A(1,6)=2*Rs*r2;
A(2,1)=0;
A(2,2)=1;
A(2,3)=-2*Rs*r2;
A(2,4)=2*Rs*r1;
A(2,5)=-2*Rs*r4;
A(2,6)=2*Rs*r3;
A(3,1)=2*Rs*(r1*r4 + r2*r3)*(2*Mc + 2*Mr + Ms);
A(3,2)=-Rs*(2*Mc + 2*Mr + Ms)*(r1^2 + r2^2 - r3^2 - r4^2);
A(3,3)=-2*r2*(2*Ir1 + 2*Ir2 + Is + Mc*d^2 + Mr*d^2);
A(3,4)=2*r1*(2*Ir1 + 2*Ir2 + Is + Mc*d^2 + Mr*d^2);
A(3,5)=2*r4*(2*Ir1 + 2*Ir2 + Is + Mc*d^2 + Mr*d^2);
A(3,6)=-2*r3*(2*Ir1 + 2*Ir2 + Is + Mc*d^2 + Mr*d^2);
A(4,1)=Rs*(2*Mc + 2*Mr + Ms)*(r1^2 - r2^2 + r3^2 - r4^2);
A(4,2)=2*Rs*(r1*r4 - r2*r3)*(2*Mc + 2*Mr + Ms);
A(4,3)=-2*r3*(2*Ir1 + 2*Ir2 + Is + Mc*d^2 + Mr*d^2);
A(4,4)=-2*r4*(2*Ir1 + 2*Ir2 + Is + Mc*d^2 + Mr*d^2);
A(4,5)=2*r1*(2*Ir1 + 2*Ir2 + Is + Mc*d^2 + Mr*d^2);
A(4,6)=2*r2*(2*Ir1 + 2*Ir2 + Is + Mc*d^2 + Mr*d^2);
A(5,1)=-2*Rs*(r1*r2 - r3*r4)*(2*Mc + 2*Mr + Ms);
A(5,2)=-2*Rs*(r1*r3 + r2*r4)*(2*Mc + 2*Mr + Ms);
A(5,3)=-2*r4*(4*Ir2 + Is + 2*Mc*d^2 + 2*Mr*d^2);
A(5,4)=2*r3*(4*Ir2 + Is + 2*Mc*d^2 + 2*Mr*d^2);
A(5,5)=-2*r2*(4*Ir2 + Is + 2*Mc*d^2 + 2*Mr*d^2);
A(5,6)=2*r1*(4*Ir2 + Is + 2*Mc*d^2 + 2*Mr*d^2);
A(6,1)=0;
A(6,2)=0;
A(6,3)=r1;
A(6,4)=r2;
A(6,5)=r3;
A(6,6)=r4;

Gx=reshape(A,[1,36]);


end